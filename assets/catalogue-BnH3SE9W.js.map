{"version":3,"file":"catalogue-BnH3SE9W.js","sources":["../../frontend/src/components/catalogue-item.tsx","../../frontend/src/pages/docs/catalogue.tsx"],"sourcesContent":["import { cn } from \"@/lib/utils\";\r\nimport type { AstNode } from \"./node-renderer\";\r\nimport { useEffect, useState } from \"react\";\r\nimport StarIcon from \"./star-icon\";\r\n\r\ninterface CatalogueItemProps {\r\n  node: AstNode;\r\n  anchor: string;\r\n  active?: boolean;\r\n  onClick?: () => void;\r\n}\r\n\r\nexport default function CatalogueItem({ node, anchor, active = false, onClick }: CatalogueItemProps) {\r\n  const level = node.attributes?.level as number;\r\n  const [isActive, setIsActive] = useState(active);\r\n  const [isHovered, setIsHovered] = useState(false);\r\n\r\n  // Calculate padding based on heading level\r\n  const paddingLeft = level ? level - 1 : 0;\r\n\r\n  useEffect(() => {\r\n    setIsActive(active);\r\n  }, [active]);\r\n\r\n  // Handle click with smooth scrolling\r\n  const handleClick = (e: React.MouseEvent) => {\r\n    e.preventDefault();\r\n    const element = document.getElementById(anchor);\r\n    if (element) {\r\n      // Scroll to element with smooth behavior\r\n      element.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\r\n\r\n      // Update URL without causing a page jump\r\n      window.history.pushState(null, \"\", `#${anchor}`);\r\n\r\n      // Set this item as active\r\n      setIsActive(true);\r\n    }\r\n    onClick?.();\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={cn(\r\n        \"py-1 transition-colors duration-200\",\r\n        isActive ? \"text-primary font-medium\" : \"hover:cursor-pointer\",\r\n      )}\r\n      onClick={handleClick}\r\n      onMouseEnter={() => setIsHovered(true)}\r\n      onMouseLeave={() => setIsHovered(false)}\r\n    >\r\n      <div style={{ paddingLeft: `${paddingLeft * 1}rem` }} className=\"flex items-center\">\r\n        <div className=\"flex-shrink-0 w-5 h-5 flex items-center justify-center\">\r\n          <StarIcon\r\n            className={cn(isActive ? \"stroke-primary\" : isHovered && \"stroke-primary/50\")}\r\n            animation=\"none\"\r\n            strokeWidth={1}\r\n          />\r\n        </div>\r\n        <a onClick={handleClick} className={cn(\"px-2 line-clamp-3 text-sm\")}>\r\n          {node.children && node.children[0].content}\r\n        </a>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import type { DocInfo } from \"@/api/doc-api\";\r\nimport CatalogueItem from \"@/components/catalogue-item\";\r\nimport { useEffect, useState, useMemo } from \"react\";\r\nimport useReactiveScrollBar from \"@/hooks/use-reactive-scroll-bar\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nexport default function Catalogue({ doc }: { doc: DocInfo }) {\r\n  const headings = useMemo(() => {\r\n    return doc.children ? doc.children.filter((node) => node.type === \"heading\") : [];\r\n  }, [doc.children]);\r\n\r\n  const [activeId, setActiveId] = useState<string>(\"\");\r\n\r\n  useEffect(() => {\r\n    if (typeof window === \"undefined\" || !window.IntersectionObserver) {\r\n      console.warn(\"IntersectionObserver not supported\");\r\n      return;\r\n    }\r\n\r\n    // Get all heading elements with IDs\r\n    const headingElements = headings\r\n      .map((heading) => {\r\n        const id = heading.attributes?.id as string;\r\n        return { id, element: document.getElementById(id) };\r\n      })\r\n      .filter((item) => item.element && item.id);\r\n\r\n    if (headingElements.length === 0) return;\r\n\r\n    // Set the first heading as active by default\r\n    setActiveId(headingElements[0].id);\r\n\r\n    const observer = new IntersectionObserver(\r\n      (entries) => {\r\n        // Get all entries that are intersecting\r\n        const visibleHeadings = entries.filter((entry) => entry.isIntersecting).map((entry) => entry.target.id);\r\n\r\n        // If we have visible headings, update the active ID\r\n        if (visibleHeadings.length > 0) {\r\n          // Use the first visible heading as the active one\r\n          setActiveId(visibleHeadings[0]);\r\n        }\r\n      },\r\n      {\r\n        // Element is considered in view when it's 30% visible\r\n        threshold: 0.3,\r\n        // Start detecting when element is near viewport\r\n        rootMargin: \"-100px 0px -66% 0px\",\r\n      },\r\n    );\r\n\r\n    // Observe all heading elements\r\n    headingElements.forEach(({ element }) => {\r\n      if (element) observer.observe(element);\r\n    });\r\n\r\n    // Clean up\r\n    return () => {\r\n      headingElements.forEach(({ element }) => {\r\n        if (element) observer.unobserve(element);\r\n      });\r\n    };\r\n  }, [headings]);\r\n\r\n  const { ref, resetCN } = useReactiveScrollBar();\r\n\r\n  return (\r\n    <div ref={ref} className={cn(\"\", resetCN)}>\r\n      {headings.map((heading, index) => (\r\n        <CatalogueItem\r\n          key={index}\r\n          node={heading}\r\n          anchor={heading.attributes?.id as string}\r\n          active={activeId === (heading.attributes?.id as string)}\r\n          onClick={() => setActiveId(heading.attributes?.id as string)}\r\n        />\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n"],"names":["CatalogueItem","node","anchor","active","onClick","level","isActive","setIsActive","useState","isHovered","setIsHovered","paddingLeft","useEffect","handleClick","e","element","jsx","cn","jsxs","StarIcon","Catalogue","doc","headings","useMemo","activeId","setActiveId","headingElements","heading","id","item","observer","entries","visibleHeadings","entry","ref","resetCN","useReactiveScrollBar","index"],"mappings":"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"}