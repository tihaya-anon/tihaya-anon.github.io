{"version":3,"mappings":";68FAMA,MAAMA,EAAgBC,EACpB,iZACA,CACE,SAAU,CACR,QAAS,CACP,QACE,iFACF,UACE,uFACF,YACE,4KACF,QACE,yEACJ,EAEF,gBAAiB,CACf,QAAS,UACX,CAEJ,EAEA,SAASC,EAAM,CACb,UAAAC,EACA,QAAAC,EACA,QAAAC,EAAU,GACV,GAAGC,CACL,EAC8D,CAC5D,MAAMC,EAAOF,EAAUG,EAAO,OAE9B,OACEC,MAACF,EAAA,CACC,YAAU,QACV,UAAWG,EAAGV,EAAc,CAAE,QAAAI,CAAA,CAAS,EAAGD,CAAS,EAClD,GAAGG,CAAA,EAGV,CCzCA,SAAwBK,EAAgB,CAAE,IAAAC,GAAwB,CAChE,OACEC,OAAC,OAAI,UAAU,4CACb,UAAAJ,MAAC,OAAI,UAAU,wCAAyC,SAAAG,EAAI,EAC5DH,MAACK,EAAA,CAAS,UAAU,SAAS,YAAa,GAAK,MAAM,GAAG,kBAAmB,EAAG,QAAQ,UAAU,GAClG,CAEJ,CCLA,MAAMC,EAAaC,OAAK,IAAAC,EAAA,IAAM,OAAO,yEAAa,OAAAC,KAAA,0DAAE,KAAMC,IAAY,CAAE,QAASA,EAAO,WAAY,CAAC,EAC/FC,EAAcJ,OAAK,IAAAC,EAAA,IAAM,OAAO,yEAAa,OAAAC,KAAA,0DAAE,KAAMC,IAAY,CAAE,QAASA,EAAO,YAAa,CAAC,EAMvG,SAAwBE,EAAK,CAAE,IAAAC,EAAK,QAAAC,EAAU,GAAO,GAAGjB,GAAoB,CAC1E,KAAM,CAACkB,EAASC,CAAU,EAAIC,WAAS,EAAI,EAC3CC,mBAAU,IAAM,EACK,IAAM,CACvB,GAAI,CACFV,EAAA,uBAAiC,wBACjCQ,EAAW,EAAK,CAClB,OAASG,EAAO,CACd,QAAQ,MAAM,wBAAyBA,CAAK,CAC9C,CACF,GAEAC,CACF,EAAG,CAACP,EAAKC,CAAO,CAAC,GAEE,IAAM,CACvB,GAAIC,EACF,OAAOf,MAACE,EAAA,CAAgB,IAAI,mBAAmB,EAEjD,MAAMmB,EAAQP,EAAUR,EAAaK,EACrC,OACEX,MAACsB,WAAA,CAAS,SAAUtB,MAACE,GAAgB,IAAI,qBAAqB,EAC5D,SAAAF,MAACqB,EAAA,CAAM,KAAMR,EAAM,GAAGhB,EAAO,EAC/B,CAEJ,GACO,CACT,CAEO,SAAS0B,EAAW,CAAE,IAAAV,GAAwB,CACnD,OAAOb,MAACY,EAAA,CAAK,IAAAC,EAAU,QAAS,GAAO,CACzC,CAEO,SAASW,EAAU,CAAE,IAAAX,GAAwB,CAClD,KAAM,CAAE,IAAAY,EAAK,QAAAC,CAAA,EAAYC,EAAA,EACzB,OACE3B,MAAC,OAAI,IAAAyB,EAAU,UAAWxB,EAAG,YAAayB,CAAO,EAC/C,SAAA1B,MAACY,EAAA,CAAK,IAAAC,EAAU,QAAS,GAAM,EACjC,CAEJ,CC/CA,SAAwBe,EAAU,CAAE,KAAAC,GAA0B,CAC5DA,EAAOA,EAAK,OACZ,KAAM,CAACC,EAAQC,CAAS,EAAId,WAAS,EAAK,EACpCe,EAAa,SAAY,CAC7B,MAAM,UAAU,UAAU,UAAUH,CAAI,EACxCE,EAAU,EAAI,EACd,WAAW,IAAMA,EAAU,EAAK,EAAG,GAAI,CACzC,EACA,OACE3B,OAAC,OAAI,UAAU,sCACb,UAAAJ,MAAC,OAAI,UAAU,mFACb,SAAAA,MAAC,UACC,QAASgC,EACT,UAAU,qKACV,aAAW,YAEV,SAAAF,QAAUG,EAAA,CAAM,KAAM,GAAI,EAAKjC,MAACkC,EAAA,CAAK,KAAM,GAAI,IAEpD,EACAlC,MAACwB,EAAA,CAAU,IAAKK,CAAA,CAAM,GACxB,CAEJ,CCnBA,MAAMM,EAAuB5B,OAAK,IAAAC,EAAA,IAAM,OAAO,uCAA+B,oOAAC,EAU/E,SAAwB4B,EAAU,CAChC,KAAAC,EACA,SAAAC,EAAW,aACX,gBAAAC,EAAkB,GAClB,UAAA7C,EACA,QAAA8C,EAAU,EACZ,EAAmB,CACjB,KAAM,CAACV,EAAQC,CAAS,EAAId,WAAS,EAAK,EACpC,CAAE,MAAAwB,CAAA,EAAUC,EAAA,EAEZV,EAAa,SAAY,CAC7B,MAAM,UAAU,UAAU,UAAUK,CAAI,EACxCN,EAAU,EAAI,EACd,WAAW,IAAMA,EAAU,EAAK,EAAG,GAAI,CACzC,EAEA,OACE3B,OAAC,OACC,UAAWH,EAAG,4DAA6DP,EAAW8C,GAAW,YAAY,EAE7G,UAAAxC,MAAC,OAAI,UAAU,8EACb,SAAAA,MAAC,UACC,QAASgC,EACT,UAAU,qKACV,aAAW,YAEV,SAAAF,QAAUG,EAAA,CAAM,KAAM,GAAI,EAAKjC,MAACkC,EAAA,CAAK,KAAM,GAAI,IAEpD,QACCZ,WAAA,CAAS,eAAWpB,EAAA,CAAgB,IAAI,gCAAgC,EACvE,SAAAF,MAACmC,EAAA,CACC,KAAAE,EACA,SAAAC,EACA,MAAAG,EACA,gBAAAF,EACA,QAAAC,CAAA,EACF,CACF,IAGN,CCdA,SAAwBG,EAAa,CAAE,KAAAC,EAAM,GAAAC,GAAgD,CAE3F,KAAM,CAAE,IAAApB,EAAK,QAAAC,CAAA,EAAYC,EAAA,EACnBmB,EAAwBC,GAA+B,CAC3D,GAAI,CAACA,EAAO,SAAU,OAAO,KAG7B,IAAIC,EAAkB,GAClBC,EAAU,GAGd,MAAMC,EAAeN,GAAkB,CACjCA,EAAK,OAAS,QAAUA,EAAK,OAAS,cACxCI,GAAmBJ,EAAK,SAAW,GACnCK,EAAU,IACDL,EAAK,OAAS,OACvBI,GAAmBJ,EAAK,SAAW,GAC1BA,EAAK,UAEdA,EAAK,SAAS,QAAQM,CAAW,CAErC,EAKA,OAHAH,EAAO,SAAS,QAAQG,CAAW,EAG/BD,QACM,QAAK,wBAAyB,CAAE,OAAQD,GAAmB,EAI9D,IACT,EAEMG,EAAkBJ,GAA+B,CAIrD,GAFqBA,EAAO,UAAU,KAAMK,GAAUA,EAAM,OAAS,QAAUA,EAAM,OAAS,YAAY,GAEtFL,EAAO,SAAU,CACnC,MAAMM,EAAaP,EAAqBC,CAAM,EAC9C,GAAIM,EACF,OAAOA,CAEX,CAGA,OAAON,EAAO,UAAU,IAAI,CAACK,EAAOE,IAAUtD,MAAC2C,EAAA,CAAyB,KAAMS,EAAO,GAAAP,CAAA,EAApBS,CAA4B,CAAE,CACjG,EAEA,GAAI,CAACV,EAAM,OAAO,KAElB,OAAQA,EAAK,MACX,IAAK,WAAY,CACf,MAAMW,EAAMX,EACZ,OACExC,OAAAoD,WAAA,CACE,UAAApD,OAAC,OAAI,UAAU,2BACb,UAAAJ,MAAC,MAAG,UAAU,yFACX,SAAAuD,EAAI,MACP,EACAvD,MAAC,KAAE,UAAU,cAAe,WAAI,KAAK,QACpC,OAAI,UAAU,2CACZ,SAAAuD,EAAI,KAAK,IAAKE,GACbzD,MAACP,GAAM,UAAU,aACd,SAAAgE,CAAA,EADgCA,CAEnC,CACD,EACH,GACF,EAECN,EAAeI,CAAG,GACrB,CAEJ,CAEA,IAAK,UAAW,CACd,MAAMG,EAASd,EAAK,YAAY,OAAoB,EAC9Ce,EAAM,IAAID,CAAK,GACrB,OAAQA,EAAA,CACN,IAAK,GACH,OACE1D,MAAC2D,EAAA,CACC,UAAU,8GACV,GAAIf,EAAK,YAAY,GAEpB,WAAeA,CAAI,IAG1B,IAAK,GACH,OACE5C,MAAC2D,EAAA,CACC,UAAU,6GACV,GAAIf,EAAK,YAAY,GAEpB,WAAeA,CAAI,IAG1B,IAAK,GACH,OACE5C,MAAC2D,EAAA,CACC,UAAU,iFACV,GAAIf,EAAK,YAAY,GAEpB,WAAeA,CAAI,IAG1B,IAAK,GACH,OACE5C,MAAC2D,EAAA,CACC,UAAU,gFACV,GAAIf,EAAK,YAAY,GAEpB,WAAeA,CAAI,IAG1B,QACE,OACE5C,MAAC2D,EAAA,CACC,UAAU,8GACV,GAAIf,EAAK,YAAY,GAEpB,WAAeA,CAAI,GACtB,CAGR,CAEA,IAAK,YACH,aAAQ,KAAE,UAAU,YAAa,SAAAO,EAAeP,CAAI,EAAE,EAExD,IAAK,OACH,OAAO5C,MAAAwD,WAAA,CAAG,WAAK,QAAQ,EAEzB,IAAK,SACH,aAAQ,UAAO,UAAU,YAAa,SAAAL,EAAeP,CAAI,EAAE,EAE7D,IAAK,WACH,aAAQ,MAAG,UAAU,SAAU,SAAAO,EAAeP,CAAI,EAAE,EAEtD,IAAK,SACH,aAAQ,OAAI,UAAU,eAAgB,SAAAO,EAAeP,CAAI,EAAE,EAE7D,IAAK,OACH,OACE5C,MAAC,KACC,KAAM4C,EAAK,YAAY,KACvB,MAAOA,EAAK,YAAY,MACxB,UAAU,+BACV,OAAO,SACP,IAAI,sBAEH,WAAeA,CAAI,IAI1B,IAAK,QACH,OACE5C,MAAC,OACC,IAAK,QAAQ6C,CAAE,IAAID,EAAK,YAAY,GAAa,GACjD,IAAMA,EAAK,YAAY,KAAkB,GACzC,UAAU,mCAIhB,IAAK,aACH,aACG,cAAW,UAAU,oDAAqD,SAAAO,EAAeP,CAAI,EAAE,EAGpG,IAAK,OAAQ,CACX,MAAMe,EAAOf,EAAK,YAAY,QAAU,KAAO,KAC/C,OACE5C,MAAC2D,EAAA,CAAI,UAAW1D,EAAG,sBAAuB2C,EAAK,YAAY,QAAU,eAAiB,WAAW,EAC9F,SAAAO,EAAeP,CAAI,EACtB,CAEJ,CAEA,IAAK,WACH,OAAO5C,MAAC,MAAI,SAAAmD,EAAeP,CAAI,EAAE,EAEnC,IAAK,QACH,OACE5C,MAAC,OAAI,IAAAyB,EAAU,UAAWxB,EAAG,kBAAmByB,CAAO,EACrD,SAAA1B,MAAC,SAAM,UAAU,0CAA0C,MAAO,CAAE,SAAU,SAC3E,SAAAmD,EAAeP,CAAI,EACtB,EACF,EAGJ,IAAK,YACH,aAAQ,SAAM,UAAU,0CAA2C,SAAAO,EAAeP,CAAI,EAAE,EAE1F,IAAK,YACH,aAAQ,SAAM,UAAU,6BAA8B,SAAAO,EAAeP,CAAI,EAAE,EAE7E,IAAK,WACH,aAAQ,MAAG,UAAU,wBAAyB,SAAAO,EAAeP,CAAI,EAAE,EAErE,IAAK,YAAa,CAEhB,MAAMgB,EAAWhB,EAAK,YAAY,SAAW,GACvCiB,EAAYD,EAAW,KAAO,KAEpC,OACE5D,MAAC6D,EAAA,CACC,UAAW5D,EACT2D,EACI,iEACA,qCACJhB,EAAK,YAAY,QAAU,UAAY,cACvCA,EAAK,YAAY,QAAU,SAAW,aACtCA,EAAK,YAAY,QAAU,QAAU,aAGtC,WAAeA,CAAI,GAG1B,CAEA,IAAK,YACH,OAAO5C,MAACoC,EAAA,CAAU,KAAMQ,EAAK,QAAmB,SAAUA,EAAK,YAAY,SAAoB,QAAO,GAAC,EAEzG,IAAK,aACH,OACE5C,MAAC,QAAK,UAAU,oFACb,WAAK,QACR,EAGJ,IAAK,aACH,OAAOA,MAACuB,EAAA,CAAW,IAAKqB,EAAK,QAAmB,EAElD,IAAK,YACH,OAAO5C,MAAC4B,EAAA,CAAU,KAAMgB,EAAK,QAAmB,EAElD,IAAK,gBACH,OAAO5C,MAAC,MAAG,UAAU,qDAAqD,EAE5E,IAAK,OACL,IAAK,aACH,OAAOA,MAAC,QAAK,wBAAyB,CAAE,OAAQ4C,EAAK,SAAW,IAAM,EAExE,QACE,eAAQ,KAAK,wBAAwBA,EAAK,IAAI,GAAIA,CAAI,EAC/CxC,OAAC,OAAI,UAAU,eAAe,mCAAuBwC,EAAK,KAAK,KAAC,EAE7E","names":["badgeVariants","cva","Badge","className","variant","asChild","props","Comp","Slot","jsx","cn","LoadingFallback","msg","jsxs","StarIcon","BlockMath_","lazy","__vitePreload","n","module","InlineMath_","Math","tex","display","loading","setLoading","useState","useEffect","error","renderMath","Math_","Suspense","InlineMath","BlockMath","ref","resetCN","useReactiveScrollBar","MathBlock","math","copied","setCopied","handleCopy","Check","Copy","LazyPrismHighlighter","CodeBlock","code","language","showLineNumbers","rounded","theme","useTheme","NodeRenderer","node","pk","processHtmlParagraph","parent","combinedContent","hasHtml","processNode","renderChildren","child","htmlResult","index","doc","Fragment","tag","level","Tag","isHeader","Component"],"ignoreList":[],"sources":["../../frontend/src/components/ui/badge.tsx","../../frontend/src/components/loading-fallback.tsx","../../frontend/src/components/math.tsx","../../frontend/src/components/math-block.tsx","../../frontend/src/components/code-block.tsx","../../frontend/src/components/node-renderer.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport { Slot } from \"@radix-ui/react-slot\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst badgeVariants = cva(\r\n  \"inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default:\r\n          \"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90\",\r\n        secondary:\r\n          \"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90\",\r\n        destructive:\r\n          \"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\r\n        outline:\r\n          \"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nfunction Badge({\r\n  className,\r\n  variant,\r\n  asChild = false,\r\n  ...props\r\n}: React.ComponentProps<\"span\"> &\r\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\r\n  const Comp = asChild ? Slot : \"span\"\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"badge\"\r\n      className={cn(badgeVariants({ variant }), className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Badge, badgeVariants }\r\n","import StarIcon from \"./star-icon\";\r\n\r\nexport default function LoadingFallback({ msg }: { msg: string }) {\r\n  return (\r\n    <div className=\"flex flex-row items-center justify-center\">\r\n      <div className=\"p-4 text-sm animate-pulse text-center\">{msg}</div>\r\n      <StarIcon animation=\"rotate\" strokeWidth={0.2} title=\"\" animationDuration={2} variant=\"primary\" />\r\n    </div>\r\n  );\r\n}\r\n","import useReactiveScrollBar from \"@/hooks/use-reactive-scroll-bar\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { useEffect, useState, lazy, Suspense } from \"react\";\r\nimport LoadingFallback from \"./loading-fallback.tsx\";\r\nconst BlockMath_ = lazy(() => import(\"react-katex\").then((module) => ({ default: module.BlockMath })));\r\nconst InlineMath_ = lazy(() => import(\"react-katex\").then((module) => ({ default: module.InlineMath })));\r\ntype MathProps = React.HTMLAttributes<HTMLSpanElement> & {\r\n  tex: string;\r\n  display?: boolean;\r\n};\r\n\r\nexport default function Math({ tex, display = false, ...props }: MathProps) {\r\n  const [loading, setLoading] = useState(true);\r\n  useEffect(() => {\r\n    const renderMath = () => {\r\n      try {\r\n        import(\"katex/dist/katex.min.css\");\r\n        setLoading(false);\r\n      } catch (error) {\r\n        console.error(\"Error rendering math:\", error);\r\n      }\r\n    };\r\n\r\n    renderMath();\r\n  }, [tex, display]);\r\n\r\n  const renderMath = () => {\r\n    if (loading) {\r\n      return <LoadingFallback msg=\"Loading LaTeX...\" />;\r\n    }\r\n    const Math_ = display ? BlockMath_ : InlineMath_;\r\n    return (\r\n      <Suspense fallback={<LoadingFallback msg=\"Rendering LaTeX...\" />}>\r\n        <Math_ math={tex} {...props} />\r\n      </Suspense>\r\n    );\r\n  };\r\n  return renderMath();\r\n}\r\n\r\nexport function InlineMath({ tex }: { tex: string }) {\r\n  return <Math tex={tex} display={false} />;\r\n}\r\n\r\nexport function BlockMath({ tex }: { tex: string }) {\r\n  const { ref, resetCN } = useReactiveScrollBar();\r\n  return (\r\n    <div ref={ref} className={cn(\"my-4 px-2\", resetCN)}>\r\n      <Math tex={tex} display={true} />\r\n    </div>\r\n  );\r\n}\r\n","import { useState } from \"react\";\r\nimport { Check, Copy } from \"lucide-react\";\r\nimport { BlockMath } from \"./math\";\r\n\r\nexport default function MathBlock({ math }: { math: string }) {\r\n  math = math.trim();\r\n  const [copied, setCopied] = useState(false);\r\n  const handleCopy = async () => {\r\n    await navigator.clipboard.writeText(math);\r\n    setCopied(true);\r\n    setTimeout(() => setCopied(false), 2000);\r\n  };\r\n  return (\r\n    <div className=\"relative group overflow-hidden my-2\">\r\n      <div className=\"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity z-50\">\r\n        <button\r\n          onClick={handleCopy}\r\n          className=\"p-1.5 rounded-md bg-primary hover:bg-primary/70 text-primary-foreground dark:bg-primary dark:hover:bg-primary/70 dark:text-primary-foreground hover:cursor-pointer\"\r\n          aria-label=\"Copy code\"\r\n        >\r\n          {copied ? <Check size={16} /> : <Copy size={16} />}\r\n        </button>\r\n      </div>\r\n      <BlockMath tex={math} />\r\n    </div>\r\n  );\r\n}\r\n","import { useState, lazy, Suspense } from \"react\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { Check, Copy } from \"lucide-react\";\r\nimport useTheme from \"@/hooks/use-theme\";\r\nimport LoadingFallback from \"./loading-fallback.tsx\";\r\n\r\n// Lazy load the syntax highlighter component\r\nconst LazyPrismHighlighter = lazy(() => import(\"./lazy-syntax-highlighter.tsx\"));\r\n\r\ninterface CodeBlockProps {\r\n  code: string;\r\n  language?: string;\r\n  showLineNumbers?: boolean;\r\n  className?: string;\r\n  rounded?: boolean;\r\n}\r\n\r\nexport default function CodeBlock({\r\n  code,\r\n  language = \"typescript\",\r\n  showLineNumbers = true,\r\n  className,\r\n  rounded = false,\r\n}: CodeBlockProps) {\r\n  const [copied, setCopied] = useState(false);\r\n  const { theme } = useTheme();\r\n\r\n  const handleCopy = async () => {\r\n    await navigator.clipboard.writeText(code);\r\n    setCopied(true);\r\n    setTimeout(() => setCopied(false), 2000);\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={cn(\"relative group overflow-hidden bg-primary-foreground my-2\", className, rounded && \"rounded-sm\")}\r\n    >\r\n      <div className=\"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity\">\r\n        <button\r\n          onClick={handleCopy}\r\n          className=\"p-1.5 rounded-md bg-primary hover:bg-primary/70 text-primary-foreground dark:bg-primary dark:hover:bg-primary/70 dark:text-primary-foreground hover:cursor-pointer\"\r\n          aria-label=\"Copy code\"\r\n        >\r\n          {copied ? <Check size={16} /> : <Copy size={16} />}\r\n        </button>\r\n      </div>\r\n      <Suspense fallback={<LoadingFallback msg=\"Loading syntax highlighter...\" />}>\r\n        <LazyPrismHighlighter\r\n          code={code}\r\n          language={language}\r\n          theme={theme}\r\n          showLineNumbers={showLineNumbers}\r\n          rounded={rounded}\r\n        />\r\n      </Suspense>\r\n    </div>\r\n  );\r\n}\r\n","import { cn } from \"@/lib/utils\";\r\nimport type { ElementType, ReactNode } from \"react\";\r\nimport type { DocInfo } from \"@/api/doc-api\";\r\nimport { Badge } from \"#/ui/badge\";\r\nimport MathBlock from \"./math-block\";\r\nimport CodeBlock from \"./code-block\";\r\nimport { InlineMath } from \"./math\";\r\nimport useReactiveScrollBar from \"@/hooks/use-reactive-scroll-bar\";\r\ntype AttributeValue = string | number | boolean;\r\ntype Attribute = Record<string, AttributeValue | AttributeValue[]>;\r\ntype AstNodeType =\r\n  | \"document\"\r\n  | \"heading\"\r\n  | \"paragraph\"\r\n  | \"text\"\r\n  | \"link\"\r\n  | \"image\"\r\n  | \"inlineCode\"\r\n  | \"codeBlock\"\r\n  | \"list\"\r\n  | \"listItem\"\r\n  | \"table\"\r\n  | \"tableHead\"\r\n  | \"tableBody\"\r\n  | \"tableRow\"\r\n  | \"tableCell\"\r\n  | \"emphasis\"\r\n  | \"strong\"\r\n  | \"delete\"\r\n  | \"blockQuote\"\r\n  | \"html\"\r\n  | \"inlineHtml\"\r\n  | \"inlineMath\"\r\n  | \"mathBlock\"\r\n  | \"thematicBreak\";\r\ntype AstNode = {\r\n  type: AstNodeType;\r\n  children?: AstNode[];\r\n  content?: string;\r\n  attributes?: Attribute;\r\n};\r\nexport type { Attribute, AttributeValue, AstNode, AstNodeType };\r\n\r\nexport default function NodeRenderer({ node, pk }: { node: AstNode; pk: string }): ReactNode {\r\n  // Process a paragraph with mixed HTML and text content\r\n  const { ref, resetCN } = useReactiveScrollBar();\r\n  const processHtmlParagraph = (parent: AstNode): ReactNode => {\r\n    if (!parent.children) return null;\r\n\r\n    // First, collect all content into a single string\r\n    let combinedContent = \"\";\r\n    let hasHtml = false;\r\n\r\n    // Traverse all children to build the combined content\r\n    const processNode = (node: AstNode) => {\r\n      if (node.type === \"html\" || node.type === \"inlineHtml\") {\r\n        combinedContent += node.content || \"\";\r\n        hasHtml = true;\r\n      } else if (node.type === \"text\") {\r\n        combinedContent += node.content || \"\";\r\n      } else if (node.children) {\r\n        // For complex nodes, we need to extract their text representation\r\n        node.children.forEach(processNode);\r\n      }\r\n    };\r\n\r\n    parent.children.forEach(processNode);\r\n\r\n    // If we found HTML content, render it all together\r\n    if (hasHtml) {\r\n      return <span dangerouslySetInnerHTML={{ __html: combinedContent }} />;\r\n    }\r\n\r\n    // If no HTML was found, return null and let the normal renderer handle it\r\n    return null;\r\n  };\r\n\r\n  const renderChildren = (parent: AstNode): ReactNode => {\r\n    // Check if parent contains HTML nodes that need special handling\r\n    const hasHtmlNodes = parent.children?.some((child) => child.type === \"html\" || child.type === \"inlineHtml\");\r\n\r\n    if (hasHtmlNodes && parent.children) {\r\n      const htmlResult = processHtmlParagraph(parent);\r\n      if (htmlResult) {\r\n        return htmlResult;\r\n      }\r\n    }\r\n\r\n    // Standard rendering for non-HTML content\r\n    return parent.children?.map((child, index) => <NodeRenderer key={index} node={child} pk={pk} />);\r\n  };\r\n\r\n  if (!node) return null;\r\n\r\n  switch (node.type) {\r\n    case \"document\": {\r\n      const doc = node as DocInfo;\r\n      return (\r\n        <>\r\n          <div className=\"flex flex-col gap-2 pb-6\">\r\n            <h1 className=\"leading-16 scroll-m-20 text-5xl text-center font-extrabold tracking-tight text-balance\">\r\n              {doc.title}\r\n            </h1>\r\n            <p className=\"text-center\">{doc.date}</p>\r\n            <div className=\"flex flex-wrap gap-2 justify-center pt-1\">\r\n              {doc.tags.map((tag) => (\r\n                <Badge className=\"text-white\" key={tag}>\r\n                  {tag}\r\n                </Badge>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {renderChildren(doc)}\r\n        </>\r\n      );\r\n    }\r\n\r\n    case \"heading\": {\r\n      const level = (node.attributes?.level as number) || 1;\r\n      const Tag = `h${level}` as ElementType;\r\n      switch (level) {\r\n        case 1:\r\n          return (\r\n            <Tag\r\n              className=\"leading-12 my-4 scroll-m-20 border-b-primary border-b-2 text-4xl font-extrabold tracking-tight text-balance\"\r\n              id={node.attributes?.id as string}\r\n            >\r\n              {renderChildren(node)}\r\n            </Tag>\r\n          );\r\n        case 2:\r\n          return (\r\n            <Tag\r\n              className=\"leading-9 my-3 scroll-m-20 border-b-primary border-b pb-2 text-3xl font-semibold tracking-tight first:mt-0\"\r\n              id={node.attributes?.id as string}\r\n            >\r\n              {renderChildren(node)}\r\n            </Tag>\r\n          );\r\n        case 3:\r\n          return (\r\n            <Tag\r\n              className=\"leading-6 my-2 scroll-m-20 border-b pb-1 text-2xl font-semibold tracking-tight\"\r\n              id={node.attributes?.id as string}\r\n            >\r\n              {renderChildren(node)}\r\n            </Tag>\r\n          );\r\n        case 4:\r\n          return (\r\n            <Tag\r\n              className=\"leading-3 my-1 scroll-m-20 border-b pb-1 text-xl font-semibold tracking-tight\"\r\n              id={node.attributes?.id as string}\r\n            >\r\n              {renderChildren(node)}\r\n            </Tag>\r\n          );\r\n        default:\r\n          return (\r\n            <Tag\r\n              className=\"leading-12 my-4 scroll-m-20 border-b-primary border-b-2 text-4xl font-extrabold tracking-tight text-balance\"\r\n              id={node.attributes?.id as string}\r\n            >\r\n              {renderChildren(node)}\r\n            </Tag>\r\n          );\r\n      }\r\n    }\r\n\r\n    case \"paragraph\":\r\n      return <p className=\"leading-7\">{renderChildren(node)}</p>;\r\n\r\n    case \"text\":\r\n      return <>{node.content}</>;\r\n\r\n    case \"strong\":\r\n      return <strong className=\"font-bold\">{renderChildren(node)}</strong>;\r\n\r\n    case \"emphasis\":\r\n      return <em className=\"italic\">{renderChildren(node)}</em>;\r\n\r\n    case \"delete\":\r\n      return <del className=\"line-through\">{renderChildren(node)}</del>;\r\n\r\n    case \"link\":\r\n      return (\r\n        <a\r\n          href={node.attributes?.href as string}\r\n          title={node.attributes?.title as string}\r\n          className=\"text-primary hover:underline\"\r\n          target=\"_blank\"\r\n          rel=\"noopener noreferrer\"\r\n        >\r\n          {renderChildren(node)}\r\n        </a>\r\n      );\r\n\r\n    case \"image\":\r\n      return (\r\n        <img\r\n          src={`docs/${pk}/${node.attributes?.src as string}`}\r\n          alt={(node.attributes?.alt as string) || \"\"}\r\n          className=\"max-w-full h-auto my-4 mx-auto\"\r\n        />\r\n      );\r\n\r\n    case \"blockQuote\":\r\n      return (\r\n        <blockquote className=\"border-primary my-6 border-l-4 pl-6 bg-primary/15\">{renderChildren(node)}</blockquote>\r\n      );\r\n\r\n    case \"list\": {\r\n      const Tag = (node.attributes?.ordered ? \"ol\" : \"ul\") as ElementType;\r\n      return (\r\n        <Tag className={cn(\"my-2 ml-6 list-disc\", node.attributes?.ordered ? \"list-decimal\" : \"list-disc\")}>\r\n          {renderChildren(node)}\r\n        </Tag>\r\n      );\r\n    }\r\n\r\n    case \"listItem\":\r\n      return <li>{renderChildren(node)}</li>;\r\n\r\n    case \"table\":\r\n      return (\r\n        <div ref={ref} className={cn(\"relative w-full\", resetCN)}>\r\n          <table className=\"w-full border-collapse border-spacing-0\" style={{ minWidth: \"500px\" }}>\r\n            {renderChildren(node)}\r\n          </table>\r\n        </div>\r\n      );\r\n\r\n    case \"tableHead\":\r\n      return <thead className=\"[&_tr]:border-b font-bold bg-primary/25\">{renderChildren(node)}</thead>;\r\n\r\n    case \"tableBody\":\r\n      return <tbody className=\"[&_tr:last-child]:border-0\">{renderChildren(node)}</tbody>;\r\n\r\n    case \"tableRow\":\r\n      return <tr className=\"border-b bg-primary/5\">{renderChildren(node)}</tr>;\r\n\r\n    case \"tableCell\": {\r\n      // Check if this cell is in a header row to determine if it should be a th or td\r\n      const isHeader = node.attributes?.header === true;\r\n      const Component = isHeader ? \"th\" : \"td\";\r\n\r\n      return (\r\n        <Component\r\n          className={cn(\r\n            isHeader\r\n              ? \"h-10 px-2 text-left align-middle font-medium whitespace-nowrap\"\r\n              : \"p-2 align-middle whitespace-nowrap\",\r\n            node.attributes?.align === \"center\" && \"text-center\",\r\n            node.attributes?.align === \"right\" && \"text-right\",\r\n            node.attributes?.align === \"left\" && \"text-left\",\r\n          )}\r\n        >\r\n          {renderChildren(node)}\r\n        </Component>\r\n      );\r\n    }\r\n\r\n    case \"codeBlock\":\r\n      return <CodeBlock code={node.content as string} language={node.attributes?.language as string} rounded />;\r\n\r\n    case \"inlineCode\":\r\n      return (\r\n        <code className=\"bg-muted relative rounded px-[0.3rem] py-[0.2rem] font-mono text-sm font-semibold\">\r\n          {node.content}\r\n        </code>\r\n      );\r\n\r\n    case \"inlineMath\":\r\n      return <InlineMath tex={node.content as string} />;\r\n\r\n    case \"mathBlock\":\r\n      return <MathBlock math={node.content as string} />;\r\n\r\n    case \"thematicBreak\":\r\n      return <hr className=\"my-6 border-t border-gray-300 dark:border-gray-700\" />;\r\n\r\n    case \"html\":\r\n    case \"inlineHtml\":\r\n      return <span dangerouslySetInnerHTML={{ __html: node.content || \"\" }} />;\r\n\r\n    default:\r\n      console.warn(`Unhandled node type: ${node.type}`, node);\r\n      return <div className=\"text-red-500\">[Unhandled node type: {node.type}]</div>;\r\n  }\r\n}\r\n"],"file":"assets/node-renderer-DalzUA_r.js"}